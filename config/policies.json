{
  "policies": [
    {
      "alert_type": "disk_utilization_low",
      "name": "Disk Utilization Low Alert",
      "patterns": [
        {
          "type": "regex",
          "pattern": "Disk utilization for\\s+([a-z0-9\\-]+)\\s+([a-z0-9\\-]+)",
          "capture_groups": {
            "project_id": 1,
            "instance_name": 2
          }
        },
        {
          "type": "regex",
          "pattern": "threshold of\\s+(\\d+(?:\\.\\d+)?)\\s+with a value of\\s+(\\d+(?:\\.\\d+)?)",
          "capture_groups": {
            "threshold_percent": 1,
            "value_percent": 2
          }
        }
      ],
      "extraction_rules": {
        "alert_type": "disk_utilization_low",
        "metric_labels": {},
        "policy_name": null,
        "condition_name": null,
        "violation_started_raw": null,
        "gcp_alert_url": null,
        "confidence": 0.9,
        "missing_fields": ["zone", "mig_name"],
        "parse_method": "policy"
      },
      
      "action_template": "gcloud compute ssh {instance_name}  --project {project_id} --internal-ip --command='sudo du -hd2 / | sort -rh | head -n 10' ",
      "summary_template": "Disk utilization below threshold. Please take following actions to see what's taking up space for example :\n\n$ sudo du -hd2 / | sort -rh | head -n 10\n27G\t/var\n25G\t/var/log <-- This is the issue\n\n{action}",
      "default_decision": "AUTO_REPLACE",
      "decision_rules": [
        {
          "condition": {
            "instance_name": {
              "startsWith": "some_intsance_name"
            }
          },
          "decision": "NEEDS_APPROVAL"
        }
      ],
      "sample_texts": [
        "Disk utilization for project-123 instance-456 threshold of 80.0 with a value of 65.5"
      ]
    },
    {
      "alert_type": "cpu_utilization_high",
      "name": "CPU Utilization High Alert",
      "patterns": [
        {
          "type": "regex",
          "pattern": "CPU utilization for\\s+([a-z0-9\\-]+)\\s+([a-z0-9\\-]+)",
          "capture_groups": {
            "project_id": 1,
            "instance_name": 2
          }
        },
        {
          "type": "regex",
          "pattern": "CPU usage\\s+(\\d+(?:\\.\\d+)?)%\\s+exceeds threshold\\s+(\\d+(?:\\.\\d+)?)%",
          "capture_groups": {
            "value_percent": 1,
            "threshold_percent": 2
          }
        }
      ],
      "extraction_rules": {
        "alert_type": "cpu_utilization_high",
        "metric_labels": {},
        "policy_name": null,
        "condition_name": null,
        "violation_started_raw": null,
        "gcp_alert_url": null,
        "confidence": 0.9,
        "missing_fields": ["mig_name", "region"],
        "parse_method": "policy"
      },
      "action_template": "gcloud beta compute instance-groups managed set-autoscaling {mig_name} --project={project_id} --region={region} --mode=on --min-num-replicas=2 --max-num-replicas=10 --target-load-balancing-utilization=0.8 --cool-down-period=300",
      "summary_template": "âš¡ *CPU Utilization High*\n\nCPU usage is above threshold. Scaling up managed instance group to handle increased load.\n\n{action}",
      "default_decision": "NEEDS_APPROVAL",
      "decision_rules": [
        {
          "condition": {
            "instance_name": {
              "startsWith": "mcoc-production-timerd"
            }
          },
          "decision": "NEEDS_APPROVAL"
        }
      ],
      "sample_texts": [
        "CPU utilization for project-123 instance-456 CPU usage 95.5% exceeds threshold 80.0%"
      ]
    },
    {
      "alert_type": "game_performance_issue",
      "name": "Game Performance Issue",
      "patterns": [
        {
          "type": "regex",
          "pattern": "game is slow",
          "capture_groups": {}
        }
      ],
      "extraction_rules": {
        "alert_type": "game_performance_issue",
        "project_id": null,
        "instance_name": null,
        "metric_labels": {},
        "threshold_percent": null,
        "value_percent": null,
        "policy_name": null,
        "condition_name": null,
        "violation_started_raw": null,
        "gcp_alert_url": null,
        "confidence": 0.8,
        "missing_fields": ["project_id", "mig_name", "region"],
        "parse_method": "llm"
      },
      "action_template": "gcloud beta compute instance-groups managed set-autoscaling {mig_name} --project={project_id} --region={region} --mode=on --min-num-replicas=2 --max-num-replicas=10 --target-load-balancing-utilization=0.8 --cool-down-period=300",
      "summary_template": "ðŸŽ® *Game Performance Issue Detected*\n\nGame performance is degraded. Scaling up managed instance group to improve performance.\n\n{action}",
      "default_decision": "NEEDS_APPROVAL",
      "sample_texts": [
        "game is slow"
      ]
    },
    {
      "alert_type": "scaling_intent_detected",
      "name": "Scaling Intent Detection",
      "patterns": [
        {
          "type": "regex",
          "pattern": "(?:scale\\s+up|scale-up|we need to scale up|need to scale up)\\s*(?:mcoc|the\\s+servers?|servers?|api|everything|production)?",
          "capture_groups": {}
        },
        {
          "type": "regex",
          "pattern": "(?:add|spin\\s+up|scale)\\s+(?:more\\s+)?(?:servers?|instances?|capacity)",
          "capture_groups": {}
        }
      ],
      "extraction_rules": {
        "alert_type": "scaling_intent_detected",
        "project_id": null,
        "instance_name": null,
        "metric_labels": {},
        "threshold_percent": null,
        "value_percent": null,
        "policy_name": null,
        "condition_name": null,
        "violation_started_raw": null,
        "gcp_alert_url": null,
        "confidence": 0.7,
        "missing_fields": ["service_name", "schedule_name", "schedule_expression"],
        "parse_method": "llm"
      },
      "action_templates": [
        {
          "label": "Scale Up options",
          "template": "MCP:execute_gcloud_scale_up",
          "description": "Give me the following information in this format to make you a PR for scaling up)\n-----\n```SCALEPRREQUEST\nStart: mm hh dd MM * YYYY (eq \"30 17 4 02 * 2026\" for 17:30 Feb 2nd 2026) (UTC zone)\nDuration: seconds (eq 7200 for 2 hours)\n ticket_number: ticket_number (eq Jira_000000)``` \n\n\n OR Execute a gcloud command to scale up instances immediately (get approval from @mcoc-release \n\n------",
          "gcloud_command_template": "gcloud beta compute instance-groups managed set-autoscaling mcoc-staging-login-api     --project=mcoc-preprod     --region=us-central1     --mode=on     --min-num-replicas=2     --max-num-replicas=5     --target-load-balancing-utilization=0.8     --cool-down-period=300"
        }
      ],
      "summary_template": "ðŸ” *Scaling Intent Detected*\n\nI detected that you need to scale up your servers. {user_intent}\n\n{action_options}",
      "default_decision": "NEEDS_APPROVAL",
      "sample_texts": [
        "we're getting crushed by traffic",
        "we need more power",
        "can we spin up more servers",
        "we're handling too much load",
        "the system is overwhelmed",
        "we need to scale up",
        "add more capacity",
        "increase server capacity",
        "we need more instances",
        "traffic is too high",
        "servers are overloaded",
        "need to handle more users"
      ]
    },
    {
      "alert_type": "add_memory_to_vm",
      "name": "Add Memory to VM",
      "patterns": [
        {
          "type": "regex",
          "pattern": "(add|increase|upgrade|more).*?(memory|ram).*?(to|for|on|in).*?(vm|virtual\\s+machine|instance)",
          "capture_groups": {}
        },
        {
          "type": "regex",
          "pattern": "(vm|virtual\\s+machine|instance).*?(needs?|requires?|wants?).*?(more\\s+)?(memory|ram)",
          "capture_groups": {}
        },
        {
          "type": "regex",
          "pattern": "(change|upgrade|modify).*?machine.*?type.*?(memory|ram)",
          "capture_groups": {}
        }
      ],
      "extraction_rules": {
        "alert_type": "add_memory_to_vm",
        "project_id": null,
        "instance_name": null,
        "metric_labels": {},
        "threshold_percent": null,
        "value_percent": null,
        "policy_name": null,
        "condition_name": null,
        "violation_started_raw": null,
        "gcp_alert_url": null,
        "confidence": 0.8,
        "missing_fields": ["environment", "service_name", "current_machine_type", "target_machine_type"],
        "parse_method": "llm"
      },
      "action_template": "MCP:generate_machine_type_diff",
      "summary_template": "ðŸ’¾ *Add Memory to VM Request Detected*\n\nI can help you add memory to a VM by generating a terragrunt configuration diff.\n\n**Required information:**\n- Environment (e.g., qaprod, production)\n- Service name (e.g., matchmakerd_drb)\n- Current machine type (e.g., c2d-standard-2)\n- Target machine type (e.g., c2d-standard-4)\n\n**Resources:**\n- Machine types: https://docs.cloud.google.com/compute/docs/compute-optimized-machines\n- Pricing: https://cloud.google.com/compute/vm-instance-pricing\n\n{action}",
      "default_decision": "NEEDS_APPROVAL",
      "sample_texts": [
        "add memory to vm",
        "increase vm memory",
        "upgrade vm memory",
        "add more memory to the vm",
        "change machine type to get more memory",
        "upgrade machine type for more memory",
        "need more memory on the vm",
        "vm needs more memory",
        "increase memory for vm"
      ]
    },
    {
      "alert_type": "scalepr_request",
      "name": "Scale PR Request",
      "patterns": [
        {
          "type": "regex",
          "pattern": "SCALEPRREQUEST",
          "capture_groups": {}
        },
        {
          "type": "regex",
          "pattern": "Start:\\s*([0-9]+\\s+[0-9]+\\s+[0-9]+\\s+[0-9]+\\s+\\*\\s+[0-9]+)",
          "capture_groups": {
            "schedule": 1
          }
        },
        {
          "type": "regex",
          "pattern": "Duration:\\s*([0-9]+)",
          "capture_groups": {
            "duration": 1
          }
        },
        {
          "type": "regex",
          "pattern": "ticket_number\\s*:\\s*([^\\n\\r]+)",
          "capture_groups": {
            "ticket_number": 1
          }
        },
        {
          "type": "regex",
          "pattern": "name:\\s*([^\\n]+)",
          "capture_groups": {
            "ticket_number": 1
          }
        }
      ],
      "extraction_rules": {
        "alert_type": "scalepr_request",
        "project_id": null,
        "instance_name": null,
        "metric_labels": {},
        "threshold_percent": null,
        "value_percent": null,
        "policy_name": null,
        "condition_name": null,
        "violation_started_raw": null,
        "gcp_alert_url": null,
        "confidence": 0.9,
        "missing_fields": ["schedule", "duration", "name"],
        "parse_method": "policy"
      },
      "_action_template_script": "MCP:generate_scaling_schedule_yaml_diff",
      "action_template": "MCP:create_scaling_schedule_pr",
      "github_owner": "explodingbarrel",
      "github_repo": "mcoc-production",
      "summary_template": "ðŸ“‹ *Scale PR Request Detected*\n\nI found a scaling PR request. Generating the YAML diff:\n\n{action}",
      "default_decision": "NEEDS_APPROVAL",
      "sample_texts": [
        "SCALEPRREQUEST\nStart: 30 17 4 02 * 2026\nDuration: 7200\nname: big sale"
      ]
    }
  ]
}

